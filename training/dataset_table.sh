#!/bin/bash

# Usage: source dataset_table.sh

TOTAL=$(cat $THERMAL_FACE_AUTOML | wc -l | bc)

TRAINING_COMBINED=$(cat $THERMAL_FACE_AUTOML | grep TRAIN | wc -l | bc)
VALIDATION_COMBINED=$(cat $THERMAL_FACE_AUTOML | grep VALIDATE | wc -l | bc)
TEST_COMBINED=$(cat $THERMAL_FACE_AUTOML | grep TEST | wc -l | bc)

TRAINING_FRACTION_COMBINED=$(echo "100 * $TRAINING_COMBINED / $TOTAL" | bc -l)
VALIDATION_FRACTION_COMBINED=$(echo "100 * $VALIDATION_COMBINED / $TOTAL" | bc -l)
TEST_FRACTION_COMBINED=$(echo "100 * $VALIDATION_COMBINED / $TOTAL" | bc -l)

TDFACE_TRAINING=$(cat $TDFACE_AUTOML | grep TRAIN | wc -l | bc)
TDFACE_VALIDATION=$(cat $TDFACE_AUTOML | grep VALIDATE | wc -l | bc)
TDFACE_TEST=$(cat $TDFACE_AUTOML | grep TEST | wc -l | bc)
TDFACE_TRAINING_FRACTION_SOURCE=$(echo "100 * (1 - $TDFACE_VALIDATION_FRACTION - $TDFACE_TEST_FRACTION)" | bc -l)
TDFACE_VALIDATION_FRACTION_SOURCE=$(echo "100 * $TDFACE_VALIDATION_FRACTION" | bc -l)
TDFACE_TEST_FRACTION_SOURCE=$(echo "100 * $TDFACE_TEST_FRACTION" | bc -l)
TDFACE_TRAINING_FRACTION_COMBINED=$(echo "100 * ($TDFACE_TRAINING / $TRAINING_COMBINED)" | bc -l)
TDFACE_VALIDATION_FRACTION_COMBINED=$(echo "100 * ($TDFACE_VALIDATION / $VALIDATION_COMBINED)" | bc -l)
TDFACE_TEST_FRACTION_COMBINED=$(echo "100 * ($TDFACE_TEST / $TEST_COMBINED)" | bc -l)

FLIR_ADAS_TRAINING=$(cat $FLIR_ADAS_AUTOML | grep TRAIN | wc -l | bc)
FLIR_ADAS_VALIDATION=$(cat $FLIR_ADAS_AUTOML | grep VALIDATE | wc -l | bc)
FLIR_ADAS_TEST=$(cat $FLIR_ADAS_AUTOML | grep TEST | wc -l | bc)
FLIR_ADAS_TRAINING_FRACTION_SOURCE=$(echo "100 * (1 - $FLIR_ADAS_VALIDATION_FRACTION - $FLIR_ADAS_TEST_FRACTION)" | bc -l)
FLIR_ADAS_VALIDATION_FRACTION_SOURCE=$(echo "100 * $FLIR_ADAS_VALIDATION_FRACTION" | bc -l)
FLIR_ADAS_TEST_FRACTION_SOURCE=$(echo "100 * $FLIR_ADAS_TEST_FRACTION" | bc -l)
FLIR_ADAS_TRAINING_FRACTION_COMBINED=$(echo "100 * ($FLIR_ADAS_TRAINING / $TRAINING_COMBINED)" | bc -l)
FLIR_ADAS_VALIDATION_FRACTION_COMBINED=$(echo "100 * ($FLIR_ADAS_VALIDATION / $VALIDATION_COMBINED)" | bc -l)
FLIR_ADAS_TEST_FRACTION_COMBINED=$(echo "100 * ($FLIR_ADAS_TEST / $TEST_COMBINED)" | bc -l)

WIDERFACE_VALIDATION_TRAINING=$(cat $WIDERFACE_VALIDATION_AUTOML | grep TRAIN | wc -l | bc)
WIDERFACE_VALIDATION_VALIDATION=$(cat $WIDERFACE_VALIDATION_AUTOML | grep VALIDATE | wc -l | bc)
WIDERFACE_VALIDATION_TEST=$(cat $WIDERFACE_VALIDATION_AUTOML | grep TEST | wc -l | bc)
WIDERFACE_VALIDATION_TRAINING_FRACTION_SOURCE=$(echo "100 * $WIDERFACE_VALIDATION_TRAINING_FRACTION" | bc -l)
WIDERFACE_VALIDATION_VALIDATION_FRACTION_SOURCE=$(echo "100 * $WIDERFACE_VALIDATION_VALIDATION_FRACTION" | bc -l)
WIDERFACE_VALIDATION_TEST_FRACTION_SOURCE=$(echo "100 * $WIDERFACE_VALIDATION_TEST_FRACTION" | bc -l)
WIDERFACE_VALIDATION_TRAINING_FRACTION_COMBINED=$(echo "100 * ($WIDERFACE_VALIDATION_TRAINING / $TRAINING_COMBINED)" | bc -l)
WIDERFACE_VALIDATION_VALIDATION_FRACTION_COMBINED=$(echo "100 * ($WIDERFACE_VALIDATION_VALIDATION / $VALIDATION_COMBINED)" | bc -l)
WIDERFACE_VALIDATION_TEST_FRACTION_COMBINED=$(echo "100 * ($WIDERFACE_VALIDATION_TEST / $TEST_COMBINED)" | bc -l)

WIDERFACE_TRAINING_TRAINING=$(cat $WIDERFACE_TRAINING_AUTOML | grep TRAIN | wc -l | bc)
WIDERFACE_TRAINING_VALIDATION=$(cat $WIDERFACE_TRAINING_AUTOML | grep VALIDATE | wc -l | bc)
WIDERFACE_TRAINING_TEST=$(cat $WIDERFACE_TRAINING_AUTOML | grep TEST | wc -l | bc)
WIDERFACE_TRAINING_TRAINING_FRACTION_SOURCE=$(echo "100 * $WIDERFACE_TRAINING_TRAINING_FRACTION" | bc -l)
WIDERFACE_TRAINING_VALIDATION_FRACTION_SOURCE=$(echo "100 * $WIDERFACE_TRAINING_VALIDATION_FRACTION" | bc -l)
WIDERFACE_TRAINING_TEST_FRACTION_SOURCE=$(echo "100 * $WIDERFACE_TRAINING_TEST_FRACTION" | bc -l)
WIDERFACE_TRAINING_TRAINING_FRACTION_COMBINED=$(echo "100 * ($WIDERFACE_TRAINING_TRAINING / $TRAINING_COMBINED)" | bc -l)
WIDERFACE_TRAINING_VALIDATION_FRACTION_COMBINED=$(echo "100 * ($WIDERFACE_TRAINING_VALIDATION / $VALIDATION_COMBINED)" | bc -l)
WIDERFACE_TRAINING_TEST_FRACTION_COMBINED=$(echo "100 * ($WIDERFACE_TRAINING_TEST / $TEST_COMBINED)" | bc -l)

cat << EOF

Total: $(printf "%'.f" $TOTAL)

| | Training set | Validation set | Test set |
| -: | -: | -: | -: |
| **Tufts Face Database (IR)** | $(printf "%'.f" $TDFACE_TRAINING) | $(printf "%'.f" $TDFACE_VALIDATION) | $(printf "%'.f" $TDFACE_TEST) |
| _Fraction of source_ | $(printf "%.f%%" $TDFACE_TRAINING_FRACTION_SOURCE) | $(printf "%.f%%" $TDFACE_VALIDATION_FRACTION_SOURCE) | $(printf "%.f%%" $TDFACE_TEST_FRACTION_SOURCE) |
| _Fraction of combined_ | $(printf "%.f%%" $TDFACE_TRAINING_FRACTION_COMBINED) | $(printf "%.f%%" $TDFACE_VALIDATION_FRACTION_COMBINED) | $(printf "%.f%%" $TDFACE_TEST_FRACTION_COMBINED) |
| **FLIR ADAS (Faces)** | $(printf "%'.f" $FLIR_ADAS_TRAINING) | $(printf "%'.f" $FLIR_ADAS_VALIDATION) | $(printf "%'.f" $FLIR_ADAS_TEST) |
| _Fraction of source_ | $(printf "%.f%%" $FLIR_ADAS_TRAINING_FRACTION_SOURCE) | $(printf "%.f%%" $FLIR_ADAS_VALIDATION_FRACTION_SOURCE) | $(printf "%.f%%" $FLIR_ADAS_TEST_FRACTION_SOURCE) |
| _Fraction of combined_ | $(printf "%.f%%" $FLIR_ADAS_TRAINING_FRACTION_COMBINED) | $(printf "%.f%%" $FLIR_ADAS_VALIDATION_FRACTION_COMBINED) | $(printf "%.f%%" $FLIR_ADAS_TEST_FRACTION_COMBINED) |
| **WIDER FACE (Validation)** | $(printf "%'.f" $WIDERFACE_VALIDATION_TRAINING) | $(printf "%'.f" $WIDERFACE_VALIDATION_VALIDATION) | $(printf "%'.f" $WIDERFACE_VALIDATION_TEST) |
| _Fraction of source_ | $(printf "%.f%%" $WIDERFACE_VALIDATION_TRAINING_FRACTION_SOURCE) | $(printf "%.f%%" $WIDERFACE_VALIDATION_VALIDATION_FRACTION_SOURCE) | $(printf "%.f%%" $WIDERFACE_VALIDATION_TEST_FRACTION_SOURCE) |
| _Fraction of combined_ | $(printf "%.f%%" $WIDERFACE_VALIDATION_TRAINING_FRACTION_COMBINED) | $(printf "%.f%%" $WIDERFACE_VALIDATION_VALIDATION_FRACTION_COMBINED) | $(printf "%.f%%" $WIDERFACE_VALIDATION_TEST_FRACTION_COMBINED) |
| **WIDER FACE (Training)** | $(printf "%'.f" $WIDERFACE_TRAINING_TRAINING) | $(printf "%'.f" $WIDERFACE_TRAINING_VALIDATION) | $(printf "%'.f" $WIDERFACE_TRAINING_TEST) |
| _Fraction of source_ | $(printf "%.f%%" $WIDERFACE_TRAINING_TRAINING_FRACTION_SOURCE) | $(printf "%.f%%" $WIDERFACE_TRAINING_VALIDATION_FRACTION_SOURCE) | $(printf "%.f%%" $WIDERFACE_TRAINING_TEST_FRACTION_SOURCE) |
| _Fraction of combined_ | $(printf "%.f%%" $WIDERFACE_TRAINING_TRAINING_FRACTION_COMBINED) | $(printf "%.f%%" $WIDERFACE_TRAINING_VALIDATION_FRACTION_COMBINED) | $(printf "%.f%%" $WIDERFACE_TRAINING_TEST_FRACTION_COMBINED) |
| **_Combined_** | $(printf "%'.f" $TRAINING_COMBINED) | $(printf "%'.f" $VALIDATION_COMBINED) | $(printf "%'.f" $TEST_COMBINED) |
| _Fraction of combined sources_ | $(printf "%.f%%" $TRAINING_FRACTION_COMBINED) | $(printf "%.f%%" $VALIDATION_FRACTION_COMBINED) | $(printf "%.f%%" $TEST_FRACTION_COMBINED) |

EOF
